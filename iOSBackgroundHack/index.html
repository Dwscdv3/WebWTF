<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>iOS Background Hack</title>
  </head>
  <body>
    <audio src="https://interactive-examples.mdn.mozilla.net/media/cc0-audio/t-rex-roar.mp3" controls loop></audio>
    <script>

// https://stackoverflow.com/a/71316630

let ctx = new AudioContext();

const oscillator = audioCtx.createOscillator();
const gain = audioCtx.createGain();
const stream = ctx.createMediaStreamDestination();

oscillator.connect(gain);
gain.connect(stream);

oscillator.type = 'sine';
oscillator.frequency.value = 440;
oscillator.start();

gain.gain.value = 0.2;

let audio = document.createElement("audio");
audio.srcObject = stream.stream;
audio.controls = true;
document.body.append(audio);

document.addEventListener("touchend", () => {
  if (ctx.state != "running")
    ctx.resume();
});

    </script>
  </body>
</html>
